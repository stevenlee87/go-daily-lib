# Chapter 9 定时器

定时器在Go语言应用中使用非常广泛，准确掌握其用法和实现原理至关重要。  
Go提供了两种定时器，此处分为一次性定时器、周期性定时器。  
- 一次性定时器：定时器只计时一次，结束便停止； 
- 周期性定时器：定时器周期性进行计时，除非主动停止，否则将永久运行；  

本章会快速介绍这两种定时器的基本用法，重点介绍其内部实现原理，最后再给出一个案例揭示使用定时器的风险。

## 9.1 一次性定时器（Timer）

### 9.1.1 快速开始

1. 简介  

2. 使用场景  
1). 设定超时时间  
2). 延迟执行某个方法

3. Timer对外接口  
1). 创建定时器  
2). 停止定时器  
3). 重置定时器

4. 简单接口  
1). After()  
2). AfterFunc()

5. 小结  
Timer内容总结如下：
   - time.NewTimer(d)创建一个Timer; 
   - timer.Stop()停掉当前Timer; 
   - timer.Reset(d)重置当前Timer;

### 9.1.2 实现原理

很多人想当然的以为，启动一个Timer意味着启动了一个协程，这个协程会等待Timer到期，
然后向Timer的管道中 发送当前时间。 

实际上，每个Go应用程序都有一个协程专门负责管理所有的Timer，这个协程负责监控Timer是否过期，
过期后执行一个预定义的动作， 这个动作对于Timer而言就是发送当前时间到管道中。

